---
title: "Sandbox"
output: html_notebook
---

```{r}
roll <- function(n, d) {
  values <- sample(1:d, n, replace = TRUE) # roll a d-sided die n times
  sum <- sum(values)
  result <- list(values, sum)
  names(result) <- c("values", "sum")
  return(result)
}

roll.stat <- function() {
  result <- roll(4, 6) # roll 4d6
  lowest <- min(result$values) # take the lowest 
  return(result$sum - lowest) # and remove it from the sum 
}

roll.stats <- function(n) {
  X <- matrix(1:n*6, nrow = n, ncol = 6)
  X[] <- sapply(X, function(ij) roll.stat())
  df <- as.data.frame(X)
  names(df) <- c(
    "strength",
    "dexterity",
    "constitution",
    "intelligence",
    "wisdom",
    "charisma"
  )
  return(df)
}

assign.race <- function() {
  races <- c(
    "dragonborn",
    "dwarf",
    "elf",
    "gnome",
    "half.elf",
    "half.orc",
    "halfling",
    "human",
    "tiefling"
  )
  return(sample(races, 1, replace = TRUE))
}
```

```{r}
set.seed(0)
stats <- roll.stats(100)
stats$race <- apply(stats, 1, function(i) assign.race())
```

```{r}
name <- c("dragonborn", "dwarf", "efl", "gnome", "half.elf", "half.orc", "halfling", "human", "tiefling")
speed <- c(30, 25, 30, 25, 30, 30, 25, 30, 30)
strength.mod <- c(2, 0, 0, 0, 0, 2, 0, 1, 0)
dexterity.mod <- c(2, 0, 0, 0, 0, 2, 0, 1, 0)
constitution.mod <- c(0, 2, 0, 0, 0, 1, 0, 1, 0)
wisdom.mod <- c(0, 0, 0, 0, 0, 0, 0, 1, 0)
intelligence.mod <- c(0, 0, 0, 2, 0, 0, 0, 1, 1)
charisma.mod <- c(1, 0, 0, 0, 2, 0, 0, 1, 2)
random1.mod <- c(0, 0, 0, 0, 1, 0, 0, 0, 0)
random2.mod <- c(0, 0, 0, 0, 1, 0, 0, 0, 0)

races <- data.frame(
  speed,
  strength.mod,
  dexterity.mod,
  constitution.mod,
  wisdom.mod,
  intelligence.mod,
  charisma.mod,
  random1.mod,
  random2.mod
)

rownames(races) <- name
races
```

```{r}
stats <- merge(x = stats, y = races, by.x = "race", by.y = "row.names", all = TRUE)
```

```{r}
stats$strength <- stats$strength + stats$strength.mod
stats
```























